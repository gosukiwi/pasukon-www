(function (root, factory) {
  if (typeof module === 'object') {
    module.exports = factory();
  } else {
    root.grammar = factory();
  }
}(this, function () { return [{"type":"LEXER","tokens":[{"type":"TOKEN_DEFINITION","name":"LEX_CLOSE","matcher":{"type":"TOKEN_MATCHER","match":"/lex"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"LEX_OPEN","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^lex\s+/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"MATCH","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^match\s+/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"IGNORE","matcher":{"type":"TOKEN_MATCHER","match":"ignore"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"COLON","matcher":{"type":"TOKEN_MATCHER","match":":"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"SEMICOLON","matcher":{"type":"TOKEN_MATCHER","match":";"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"PIPE_ARROW","matcher":{"type":"TOKEN_MATCHER","match":"|>"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"PIPE","matcher":{"type":"TOKEN_MATCHER","match":"|"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"POPEN","matcher":{"type":"TOKEN_MATCHER","match":"("},"action":"match"},{"type":"TOKEN_DEFINITION","name":"PCLOSE","matcher":{"type":"TOKEN_MATCHER","match":")"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"QUESTION_MARK","matcher":{"type":"TOKEN_MATCHER","match":"?"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"PLUS","matcher":{"type":"TOKEN_MATCHER","match":"+"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"TIMES","matcher":{"type":"TOKEN_MATCHER","match":"*"},"action":"match"},{"type":"TOKEN_DEFINITION","name":"REGEX_MATCHER","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^\/[^\/]*\//},"action":"match"},{"type":"TOKEN_DEFINITION","name":"REGEX_MATCHER","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^{[^}]*}/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"CODE","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^'[^']*'/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"CODE","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^\"[^\"]*\"/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"NAME","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^[a-zA-Z][a-zA-Z0-9_-]*/},"action":"match"},{"type":"TOKEN_DEFINITION","name":"WHITESPACE","matcher":{"type":"TOKEN_REGEX_MATCHER","regex":/^\s+/},"action":"ignore"}]},{"type":"RULE","name":"token-action","definitions":[{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"MATCH"},"code":function($1,$2,$,$ctx){return $1.trim()}},{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"IGNORE"}}]},{"type":"RULE","name":"token-matcher","definitions":[{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"CODE"},"code":function($1,$2,$,$ctx){return { type: "TOKEN_MATCHER", match: $1.substring(1, $1.length - 1) }}},{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"REGEX_MATCHER"},"code":function($1,$2,$,$ctx){return { type: "TOKEN_REGEX_MATCHER", regex: $1.substring(1, $1.length - 1) }}}]},{"type":"RULE","name":"token-definition","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"token-action"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"action"}}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"NAME"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"name"}}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"token-matcher"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"matcher"}}}},"code":function($1,$2,$,$ctx){return { type: "TOKEN_DEFINITION", name: $.name, matcher: $.matcher, action: $.action }}}]},{"type":"RULE","name":"lexer","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"LEX_OPEN"}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"many0","arg":{"type":"RULE_CALL","name":"token-definition"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"tokens"}}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"LEX_CLOSE"}}},"code":function($1,$2,$,$ctx){return { type: "LEXER", tokens: $.tokens }}}]},{"type":"RULE","name":"parser-name","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"POPEN"}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rule-expression"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"expr"}}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"PCLOSE"}}},"code":function($1,$2,$,$ctx){return $.expr}},{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"QUESTION_MARK"}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"parser-name"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"arg"}}},"code":function($1,$2,$,$ctx){return { type: "UNARY_CALL", parser: "opt", arg: $.arg }}},{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"PLUS"}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"parser-name"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"arg"}}},"code":function($1,$2,$,$ctx){return { type: "UNARY_CALL", parser: "many1", arg: $.arg }}},{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"TIMES"}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"parser-name"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"arg"}}},"code":function($1,$2,$,$ctx){return { type: "UNARY_CALL", parser: "many0", arg: $.arg }}},{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"COLON"}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"parser-name"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"arg"}}},"code":function($1,$2,$,$ctx){return { type: "UNARY_CALL", parser: "token", arg: $.arg }}},{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"NAME"},"code":function($1,$2,$,$ctx){return { type: "RULE_CALL", name: $1 }}}]},{"type":"RULE","name":"rule-expression","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"parser-name"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"lhs"}}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"NAME"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"parser"}}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rule-expression"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"rhs"}}}},"code":function($1,$2,$,$ctx){return { type: "BINARY_CALL", parser: $.parser, lhs: $.lhs, rhs: $.rhs }}},{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"NAME"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"name"}}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rule-expression"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"arg"}}},"code":function($1,$2,$,$ctx){return { type: "UNARY_CALL", parser: $.name, arg: $.arg }}},{"type":"RULE_CALL","name":"parser-name"}]},{"type":"RULE","name":"rule-eval","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"opt","arg":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"PIPE_ARROW"}}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"CODE"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"code"}}},"code":function($1,$2,$,$ctx){return $.code.substring(1, $.code.length - 1)}}]},{"type":"RULE","name":"rule-definition","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"PIPE"}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rule-expression"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"expr"}}},"rhs":{"type":"UNARY_CALL","parser":"opt","arg":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rule-eval"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"code"}}}}},"code":function($1,$2,$,$ctx){$.code ? $.expr.code = $.code : null; return $.expr}}]},{"type":"RULE","name":"rule","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"NAME"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"name"}}},"rhs":{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"UNARY_CALL","parser":"many1","arg":{"type":"RULE_CALL","name":"rule-definition"}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"definitions"}}},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"SEMICOLON"}}},"code":function($1,$2,$,$ctx){return { type: "RULE", name: $.name, definitions: $.definitions }}}]},{"type":"RULE","name":"rules","definitions":[{"type":"UNARY_CALL","parser":"many0","arg":{"type":"RULE_CALL","name":"rule"}}]},{"type":"RULE","name":"start","definitions":[{"type":"BINARY_CALL","parser":"then","lhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"lexer"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"lexer"}}},"rhs":{"type":"BINARY_CALL","parser":"as","lhs":{"type":"RULE_CALL","name":"rules"},"rhs":{"type":"UNARY_CALL","parser":"token","arg":{"type":"RULE_CALL","name":"rules"}}},"code":function($1,$2,$,$ctx){return [$.lexer].concat($.rules)}},{"type":"RULE_CALL","name":"rules"}]}] }));